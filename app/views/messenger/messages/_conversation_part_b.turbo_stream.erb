
<%= turbo_stream.prepend "conversations-list" do %>
  <%= render "messenger/conversations/conversation_row", {
    c: message.conversation,
    message: message,  
    app: message.conversation.app
  } %>
<% end %>

<% if !message.read? && message.authorable_type == "Agent" %>
  <%= turbo_stream.update "chaskiq-custom-events" do %>
    <%= render "shared/pling", data: data %>
  <% end %>
<% end %>

<% if message.was_created? %>
  <%= turbo_stream.prepend_all "#conversation-#{message.conversation.key}" do %>
    <%= render "messenger/messages/conversation_part", **local_assigns %>
  <% end %>

<% else %>
  <%= turbo_stream.update_all "#conversation-part-#{message.key}" do %>
    <%= render "messenger/messages/conversation_part", **local_assigns %>
  <% end %>
<% end %>
